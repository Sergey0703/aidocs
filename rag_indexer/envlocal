# Optimized settings for powerful system (42GB RAM, 2 Xeon CPUs)
# Configured for nomic-embed-text model with CPU-only processing
SUPABASE_CONNECTION_STRING="postgresql://postgres:postgres@localhost:54322/postgres"
OLLAMA_BASE_URL=http://localhost:11434
MASTER_DOCUMENTS_DIR=./data/634/
DOCUMENTS_DIR=./data/634/2025/1
DOC_BACKUP_ABSOLUTE_PATH=./data/doc_backups
TABLE_NAME=documents

# Embedding model settings - nomic-embed-text optimized for CPU
EMBED_MODEL=nomic-embed-text
EMBED_DIM=768                  # nomic-embed-text uses 768 dimensions

# Text chunking settings - smaller chunks for faster processing
CHUNK_SIZE=2048                # Reduced from 1024 for faster embedding generation
CHUNK_OVERLAP=256              # Reduced proportionally to maintain quality
MIN_CHUNK_LENGTH=100           # Slightly reduced minimum length
BATCH_RESTART_INTERVAL=5
ENABLE_TEXT_QUALITY_ANALYSIS=true

# Processing batch settings - optimized for CPU performance
BATCH_SIZE=10                  # Increased from 1 for better CPU utilization
NUM_WORKERS=4                  # Utilize multiple CPU cores for file processing

# OCR optimization settings
ENABLE_OCR=true
OCR_BATCH_SIZE=10
OCR_WORKERS=4
OCR_QUALITY_THRESHOLD=0.3

# Document conversion settings
AUTO_CONVERT_DOC=true          # Автоматически конвертировать .doc файлы
BACKUP_ORIGINAL_DOC=true       # Создавать резервные копии .doc файлов
DELETE_ORIGINAL_DOC=false

# ============================================================================
# ENHANCED PDF PROCESSING SETTINGS (ИСПРАВЛЕНО И ДОПОЛНЕНО)
# ============================================================================

# Core PDF settings
ENABLE_ENHANCED_PDF_PROCESSING=true
PDF_CHUNK_SIZE=2048            # ИСПРАВЛЕНО: убраны пробелы
PDF_PRESERVE_STRUCTURE=true   # ИСПРАВЛЕНО: убраны пробелы, lowercase
PDF_MIN_SECTION_LENGTH=200     # ИСПРАВЛЕНО: убраны пробелы
PDF_HEADER_DETECTION=true      # ИСПРАВЛЕНО: убраны пробелы, lowercase
PDF_FOOTER_CLEANUP=true        # ИСПРАВЛЕНО: убраны пробелы, lowercase

# PDF processing strategy (НОВЫЕ НАСТРОЙКИ)
PDF_AUTO_METHOD_SELECTION=true
PDF_PREFER_PYMUPDF=true
PDF_ENABLE_TABLE_EXTRACTION=true
PDF_SCANNED_THRESHOLD=0.1
PDF_TABLE_DETECTION_THRESHOLD=0.3

# PDF OCR fallback (НОВЫЕ НАСТРОЙКИ)
PDF_ENABLE_OCR_FALLBACK=true
PDF_OCR_DPI=300
PDF_OCR_IMAGE_FORMAT=jpeg
PDF_OCR_MIN_TEXT_LENGTH=20
PDF_OCR_TIMEOUT_PER_PAGE=30

# PDF quality and validation (НОВЫЕ НАСТРОЙКИ)
PDF_MIN_CONTENT_LENGTH=20
PDF_MAX_PAGES_FOR_QUICK_ANALYSIS=3
PDF_ENABLE_CONTENT_VALIDATION=true

# PDF logging (НОВЫЕ НАСТРОЙКИ)
LOG_PDF_PROCESSING_DETAILS=true

# ============================================================================

# Database batch settings - larger batches for efficiency
DB_BATCH_SIZE=1000             # Increased for better database performance
PROCESSING_BATCH_SIZE=200      # Increased from 25 for better throughput
SKIP_VALIDATION=false

# Ollama optimization settings for CPU-only processing
OLLAMA_KEEP_ALIVE=-1           # Longer keep-alive to reduce model reload overhead
OLLAMA_MAX_LOADED_MODELS=1     # Keep only one model loaded to conserve memory
OLLAMA_NUM_PARALLEL=1          # Single parallel request for CPU processing
OLLAMA_TIMEOUT=300             # 5 minutes timeout for slower CPU processing

# CPU-specific optimizations
OLLAMA_NUM_THREAD=16           # Use more CPU threads for nomic-embed-text
OLLAMA_NUMA=false              # Disable NUMA for consistency on dual-Xeon setup

# Performance monitoring settings
ENABLE_PROGRESS_LOGGING=true
LOG_BATCH_TIMING=true